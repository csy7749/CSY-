# 什么是GOAP
引用原文的一句话 ： 目标导向型行动计划（简称GOAP）是一种能够轻松呈现给你的代理选择的AI系统，也是帮助你可以无需维持一个庞大且复杂的有限状态机而做出明智的决策的机器。GOAP的一个Action只有在其**所有前提条件都得到满足**的情况下才能执行，并且每个动作都会以某种方式**改变世界的状态**。

也就是， 让AI创造他们自己的方法去解决问题，我们提供给它一系列可能的动作作为对**这个世界的描述**，和**每个动作使用的先决条件**，和**行动带来的影响**。**AI拥有一个初始状态和他需要达到的目标**。有一组目标，AI可以通过优先级或当前状态选择一个。**计划系统**决定一个动作序列来满足当 前目标，计划出一个像路径一样的能最简单达到目标状态的动作序列。
# Agent
代理，主体，负责连接各个类，主要逻辑在这里运行
# Action
动作，可以被执行得动作，比如：拿东西，丢东西
# Planer
决策者，通过各个类来决策出最优的路线Agent使用
# IGoap
数据提供者，提供给Agent目标和反馈是否成功失败等等
# **GOAP 的主要逻辑：**
1.Agent的状态机初始化Idle状态

2.Idel状态根据IGoap提供的数据，通过Planer得到最优路线

3.Agent的状态机转换状态到PerformAction状态

4.PerformAction状态解析路线，执行路线的动作队列

5.如果动作需要到范围内，切换到MoveTo状态移动到目标范围，否则执行动作队列

6.当全部动作执行完毕，告诉IGoap目标达成，转换到Idle状态

GOAP是一个反向链接搜索，从要实现的目标开始，找到什么动作能实现目标，在寻找刚才动作的先决条件，一直往前推，知道达到你的当前（初始）状态。这种反向链接搜索替代了启发式的前向链接搜索。  
伪代码：  
把目标加到未解决事件列表  
对于每个为解决事件（for）  
移除这个为解决事件  
找到达成事件的动作  
如果动作的先决条件已经满足  
增加动作到计划中  
往回推需要达到先决条件的动作到计划中  
否则  
添加该先决条件到未解决时间中

**例 如**：我们建立一个NPC士兵，把它的目标设为杀死其他敌人，我们设置它的目标为Target.Dead。为了让目标去死，NPC必须要有一个武器用来射 击，这是一个先决条件，但是现在NPC并没有正在装备的武器，NPC就需要执行找到武器这个动作，如果NPC有武器库，他就会从武器库中拿一个，如果没有武器库，就需要寻路去找一个武器装备了。得到武器装备之后就要找到敌人，实现方式多种多样，徒步寻找、或者NPC周围有车也可以开着车去寻找。发现，我们给NPC大量的动作选择，让NPC自己决定该做什么，因而产生动态不可预知又有趣的行为，而且表现得很自然，比开发者创建行为好多了。

